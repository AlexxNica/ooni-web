<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on OONI: Open Observatory of Network Interference</title>
    <link>/post/</link>
    <description>Recent content in Posts on OONI: Open Observatory of Network Interference</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 15 Jul 2013 00:00:00 +0000</lastBuildDate>
    <atom:link href="/post/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Zambia, a country under Deep Packet Inspection</title>
      <link>/post/zambia/</link>
      <pubDate>Mon, 15 Jul 2013 00:00:00 +0000</pubDate>
      
      <guid>/post/zambia/</guid>
      <description>

&lt;p&gt;&amp;ldquo;I do not have the details of the blocking of Zambianwatchdog.com, but I
    would celebrate.&amp;rdquo;
                          Guy Scott
                          Zambian Vicepresident, Friday 28th June 2013&lt;/p&gt;

&lt;p&gt;The following article is a guest blog post by Mr T. an independent researcher
and provider of hosting to various grass roots organizations.&lt;/p&gt;

&lt;p&gt;This article summarizes how we discovered that the grass roots online newspaper
Zambianwatchdog.com was being blocked inside Zambia. This report provides
technical evidence of the unlawful presence of Deep Packet Inspection in the
country to monitor the Internet communications and stop users from browsing the
website.&lt;/p&gt;

&lt;h1 id=&#34;the-connection-was-reset:35837baaac9f2cd7270d225e40661177&#34;&gt;The connection was reset&lt;/h1&gt;

&lt;p&gt;On Monday 24 June 15:30 GMT readers of the website Zambianwatchdog.com from
inside Zambia were reporting error messages.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/zambia/connection-rst.jpg&#34; alt=&#34;Connection RST&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;As hosting providers of the website, we initially could not see a significant
drop of active connections and we needed to have a close look into the access
logs of the site. Examining the connection logs to find any pattern that could
help us to determine the cause of the problem was not a straightforward task as
we needed to examine several gigabytes of data. It is worth mentioning here
that Zambian Watchdog ranks 8th overall biggest website in Zambia and probably
the biggest site after the large portals Facebook, Google or Youtube.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/zambia/alexa-traffic-ranks.png&#34; alt=&#34;Alexa ranks&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;Our first review of the logs revealed a clear increase of connections reporting
status code 200 but with zero bytes were transmitted back to the client.&lt;/p&gt;

&lt;p&gt;The server has large number of logs similar to this one:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;41.72.105.x - - [25/Jun/2013:05:03:58 +0000]  &amp;quot;GET / HTTP/1.1&amp;quot; 200 0 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (Windows NT 6.1; rv:20.0) Gecko/20100101 Firefox/20.0&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The sample shows that IP address of this connection 41.72.105.x belongs to
ZAMTEL, the status code of the connection is 200 and zero information was sent
back to the client.&lt;/p&gt;

&lt;p&gt;The status code 200 indicates that the client&amp;rsquo;s request was successfully
received, understood, and accepted by the server but for some unknown reason no
information was send back to the client.&lt;/p&gt;

&lt;p&gt;In order to determine if this was a general problem of our servers we examined
the last four weeks of connection logs to conclude that there was inexplicable
increase of connections with status code 200 and zero bytes transmitted
starting that day.&lt;/p&gt;

&lt;p&gt;We also looked into which readers were affected by this behavior and we
concluded that the majority of the connections reporting this problem were from
operators inside Zambia with the exception of MTN.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/zambia/pie-chart.png&#34; alt=&#34;Pie chart&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;Origin of the dropped connections to the webserver&lt;/p&gt;

&lt;h1 id=&#34;who-is-breaking-the-connections:35837baaac9f2cd7270d225e40661177&#34;&gt;Who is breaking the connections?&lt;/h1&gt;

&lt;p&gt;Four hours after we received the first reports of service outage inside Zambia
we could narrow down the problem to what it was perceived in the server side as
sudden termination of the connections.&lt;/p&gt;

&lt;p&gt;Comparing the connection logs of different weeks we could determine that
connections coming from at least these operators AS37146 realtime-as, AS37214
MICROLINK, AS28698 UUNET Africa, AS37287 ZAIN-ZAMBIA and AS37154 ZAMTEL were
suffering from some kind disruption.&lt;/p&gt;

&lt;p&gt;In order to determine what kind of interference was taken place we proceed to
capture the network traffic arriving to Zambian Watchdog&amp;rsquo;s server to look for
any special patters that could help us to understand why most of the readers
inside Zambia were experiencing connection drops with the exception of readers
using MTN mobile network.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/zambia/wireshark.png&#34; alt=&#34;Wireshark&#34; /&gt;

After reviewing dozen of different packet captures we saw a
distinctive pattern&lt;/p&gt;

&lt;p&gt;The readers seemed to be able to establish the initial connection with the
webserver but as soon as they request any content of the website we received
also a request to terminate such connection.&lt;/p&gt;

&lt;p&gt;We proceed to examine our own generated connections from inside Zambia in real
time and discovered that the undesired termination was taken place if the HTTP
Header Host: www.zambianwatchdog.com was present in the request.&lt;/p&gt;

&lt;p&gt;For example, we could see that a connection requesting the Breaking News
section of the site from a Nokia phone, using Celtel 3G network was always
quickly terminated after this request arrives to the server.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;GET /category/breaking-news/ HTTP/1.1 
Host: www.zambianwatchdog.com

Accept: text/html,text/css,multipart/mixed,application/java-archive,
application/java, application/x-java-archive, text/vnd.sun.j2me.app-descriptor,
application/vnd.oma.drm.message, application/vnd.oma.drm.content,
application/vnd.oma.dd+xml, application/vnd.oma.drm.rights+xml,
application/vnd.oma.drm.rights+wbxml, application/x-nokia-widget, */* 

Accept-Charset: iso-8859-1, utf-8; q=0.7, *; q=0.7 

Accept-Encoding: gzip, deflate, x-gzip, identity; q=0.9 

Accept-Language: en;q=1.0,fr;q=0.5,de;q=0.5,it;q=0.5 

Referer: http://www.google.co.zm/search?q=wachdog+news&amp;amp;btnG=Search 

User-Agent: Mozilla/5.0 (SymbianOS/9.2; U; Series60/3.1 NokiaE63-1/500.21.009;
Profile/MIDP-2.0 Configuration/CLDC-1.1 ) AppleWebKit/413 (KHTML, like Gecko)
Safari/413 

x-wap-profile: &amp;quot;http://nds1.nds.nokia.com/uaprof/NE63-1r100.xml&amp;quot; 

X-Nokia-MusicShop-Version: 08.0825.9 

X-Nokia-MusicShop-Bearer: GPRS/3G
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;dpi-or-not-dpi:35837baaac9f2cd7270d225e40661177&#34;&gt;DPI or not DPI?&lt;/h1&gt;

&lt;p&gt;What it was left to determine if the filtering was looking into other aspects
of the connection. In order to find out we run a few extra tests, requesting
access to the webpage using other headers. We tested requests using the
following headers&lt;/p&gt;

&lt;p&gt;www.zambianwatchdog.COM&lt;/p&gt;

&lt;p&gt;zambianwatchdog.com&lt;/p&gt;

&lt;p&gt;Zambianwatchdog.cOm&lt;/p&gt;

&lt;p&gt;wWw.zambianwatchdog.com&lt;/p&gt;

&lt;p&gt;To our surprise we discovered that the “reset” of the connections was only
talking place when we used the header www.zambianwatchdog.com and not when
using any of the other combinations. After twelve hours we could confirm that
malicious traffic was not generated by the readers but was actively injected
into the network when a reader was requesting content from the website
www.zambianwatchdog.com and that this behavior could only be explained by the
presence of deep packet inspection (DPI) equipment inside Zambia.&lt;/p&gt;

&lt;p&gt;Not until we technically verified and gathered forensic evidence of the
blocking we adviced to the website owners to inform to the general public that
such active interference was talking place and that the blocking was clearly
targeted against the website.&lt;/p&gt;

&lt;h1 id=&#34;getting-the-website-back-online:35837baaac9f2cd7270d225e40661177&#34;&gt;Getting the website back online&lt;/h1&gt;

&lt;p&gt;To ensure the public visibility of the website inside Zambia and in order to
look for a quick solution to put the website online, we tested the availability
of the blocking technology to interfere with encrypted traffic. After testing
the encypted (SSL) traffic was not suffering from such type of interference the
decided to make the site available only via HTTPS.&lt;/p&gt;

&lt;p&gt;To our surprise, several popular Word Press plugins of the website needed some
tweaks so the full content was delivered encrypted to the readers.&lt;/p&gt;

&lt;p&gt;We have also included the header&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Strict-Transport-Security &amp;quot;max-age=10886401; includeSubDomains&amp;quot;;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;to ensure that the readers that have reached the website at least once via
HTTPS will keep doing it so without the need to specify HTTPS in their future
requests.&lt;/p&gt;

&lt;h1 id=&#34;ooni-testing:35837baaac9f2cd7270d225e40661177&#34;&gt;OONI Testing&lt;/h1&gt;

&lt;p&gt;Inspired by the work of our colleges of the Open Observatory of Network
Interferece (OONI) we conducted another run of tests to determine if any of
1000 top Alexa websites was blocking. The result of the testing is that we
could not find any other website blocked with the exception of the Zambian
Watchdog.&lt;/p&gt;

&lt;h1 id=&#34;blocking-status:35837baaac9f2cd7270d225e40661177&#34;&gt;Blocking status&lt;/h1&gt;

&lt;p&gt;Three weeks after we initially detected and fingerprinted the blocking, the
filtering is still active. Unencrypted requests to the domain
zambianwatchdog.com remain unblocked while connections using
www.zambianwatchdog.com trigger a reset.&lt;/p&gt;

&lt;p&gt;Our test software that runs inside Zambia still reports interference when using
www.zambianwatchdog.com&lt;/p&gt;

&lt;p&gt;Recv failure: Connection reset by peer&lt;/p&gt;

&lt;p&gt;While such interference is not present when dropping the www.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;HTTP/1.1 301 Moved Permanently 

Server: nginx 

Date: Sat, 13 Jul 2013 12:35:16 GMT 

Content-Type: text/html 

Content-Length: 178 

Location: https://&#39;&#39;&#39;zambianwatchdog.com/&#39;&#39;&#39; 

Strict-Transport-Security: max-age=10886401; includeSubDomains 
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;courage-is-contagious:35837baaac9f2cd7270d225e40661177&#34;&gt;Courage is contagious&lt;/h1&gt;

&lt;p&gt;After we unveiled the blocking and network monitoring, Zambian Watchdog has
received information from whistle blowers of the presence of such
infrastructure.&lt;/p&gt;

&lt;p&gt;The 4th of July, the Zambian website reports&lt;/p&gt;

&lt;p&gt;&amp;ldquo;They have also installed equipment a Lamya (1) in order to monitor people
blogging on a site like yours and also blocking watchdog. This is also
affecting all the other internet service providers who are using Zamtel as a
currier and service provider. Also the CODEX (2) which interconnects all ISP is
based at Lamya and this has given OP (3) access to all the ISP in Zambia.&amp;rdquo;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Lamya is the location of the &amp;ldquo;Zambia&amp;rdquo; Telecommunications Company&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;CODEX is the Zambian Internet exchange OP is the Office of the President&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Further information about the case:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://zambianwatchdog.com/corruption-worsens-at-zamtel-emails-phones-being-monitored-at-lamya-house/&#34;&gt;Corruption worsens at zamtel emails phones being-monitored at lamya house&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://zambianwatchdog.com/zicta-suing-of-mobile-companies-aimed-at-mtn-for-refusing-to-block-zwd/&#34;&gt;Zicta suing of mobile companies aimed at mtn for refusing to block zwd&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://zambianwatchdog.com/sata-orders-op-to-block-zwd-on-mtn-as-well/&#34;&gt;Sata orders op to block zwd on mtn as well&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://zambianwatchdog.com/sata-signs-order-for-op-to-tap-phones-emails/&#34;&gt;Sata signs order for op to tap phones emails&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://zambianwatchdog.com/journalist-zyambo-out-of-jail-police-though-he-had-obituary-of-sata/&#34;&gt;Journalist zyambo out of jail police though he had obituary of sata&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&#34;update-17th-july-2013-and-ssl-got-blocked:35837baaac9f2cd7270d225e40661177&#34;&gt;Update (17th July 2013): And SSL got blocked&amp;hellip;&lt;/h1&gt;

&lt;p&gt;On Tuesday 16th of July 2013 (14:43 GMT) just a few hours after this article
was released, the government has moved forward in their determination of
blocking the site and started to block the SSL connections.  The Deep Packet
Inspection gear seems to be monitoring the &amp;ldquo;Server Hello&amp;rdquo; message that is part
of the SSL negotiation. This message contains the string zambianwatchdog.com
before the SSL negotiation is completed.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/zambia/SSL-reset.png&#34; alt=&#34;SSL Reset&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;In order to find out if the government is actively making changes, we deployed
a new mirror server of the site in the domain &lt;a href=&#34;http://zwd.cums.in&#34;&gt;http://zwd.cums.in&lt;/a&gt;. After a few
hours the domain has also been blocked and the filtering has been extended to
the whole /24 network. By extending the filtering the Zambian government has
also blocked hundreds of other organizations that are hosted in the same provider.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;41.72.122.69 - - [17/Jul/2013:14:17:16 +0000]  &amp;quot;-&amp;quot; 400 0 &amp;quot;-&amp;quot; &amp;quot;-&amp;quot; &amp;quot;---&amp;quot; &amp;quot;ZM&amp;quot; &amp;quot;-x-&amp;quot; &amp;quot;41.72.122.69&amp;quot; &amp;quot;-&amp;quot;
41.72.122.69 - - [17/Jul/2013:14:17:16 +0000]  &amp;quot;-&amp;quot; 400 0 &amp;quot;-&amp;quot; &amp;quot;-&amp;quot; &amp;quot;---&amp;quot; &amp;quot;ZM&amp;quot; &amp;quot;-x-&amp;quot; &amp;quot;41.72.122.69&amp;quot; &amp;quot;-&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is an example of the logs in the server side. We can see that the attack
they are conducting leads to 0 bytes being transmitted and an error code 400 is
generated (Error 400 (Bad Request) takes place when the request to a SSL is
malformed.).&lt;/p&gt;

&lt;p&gt;More information is available here
&lt;a href=&#34;https://zambianwatchdog.com/police-abduct-another-journalists-suspected-of-links-to-zwd-govt-blocks-zwd-futher/&#34;&gt;https://zambianwatchdog.com/police-abduct-another-journalists-suspected-of-links-to-zwd-govt-blocks-zwd-futher/&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Tab-Tab, Come in! Bypassing Internet blocking to categorize DPI devices</title>
      <link>/post/tab-tab-come-in/</link>
      <pubDate>Tue, 14 May 2013 00:00:00 +0000</pubDate>
      
      <guid>/post/tab-tab-come-in/</guid>
      <description>

&lt;h1 id=&#34;motivation:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;Motivation&lt;/h1&gt;

&lt;p&gt;During the past two years, we have been following the technical developments in
Internet filtering in Uzbekistan and Turkmenistan. Internet users were
reporting that some websites were blocked, connections were reseted and in some
cases users were redirected to another website.&lt;/p&gt;

&lt;p&gt;Apart from our technical curiosity of how Internet filtering is implemented at
large scale and how it can be circumvented, we are interested in providing
technical facts of how blocking is taking place. The lack of technical
information in this field has an interesting collateral effect in Internet
users. Lack of information, help rumours to spread and consolidate the idea
that governments have unlimited capabilities, that not only monitor all
communications but that ultimately nothing can be done to stop their control.
Understanding how Internet filtering is taking place is an important task as it
allows to discover mechanisms to bypass it and fingerprint and ultimately
expose the companies that provide technology and know-how to governments that
want to surpress the free flow of information in the Net.&lt;/p&gt;

&lt;h1 id=&#34;our-findings:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;Our findings&lt;/h1&gt;

&lt;p&gt;The general Internet blocking architecture in Turkmenistan and Uzbekistan takes
places in two basic stages. The first stage is responsible to identify which
web/HTTP sessions are trying to reach a blacklisted website. This first stage
is hence responsible of matching if a certain user is trying to reach a website
that is blacklisted. Once the positive matching has taken place, the blocking
or filtering is implemented. We will refer to the first stage as &amp;ldquo;matching&amp;rdquo; and
the second as &amp;ldquo;blocking&amp;rdquo;.&lt;/p&gt;

&lt;h2 id=&#34;matching:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;Matching&lt;/h2&gt;

&lt;p&gt;During our technical investigation we found out that a key element in the
matching stage is the &amp;ldquo;Host header&amp;rdquo; in a HTTP session. Once the initial
handshake between user and the final webserver is established (TCP/IP
handshake) the browser will send a HTTP packet with a content like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;GET / HTTP/1.1 Host: www.youtube.com
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This first packet tells to the webserver that we want to request the homepage
of the website www.youtube.com&lt;/p&gt;

&lt;p&gt;The Host header was introduced to be able to specify which domain we are
requesting in the common scenario that a single IP address is serving different
websites (think here in shared/virtual hosting). The Host header is optional in
HTTP 1.0 but mandatory in HTTP 1.1. According the standards, the GET request
line and the Host header must end with carriage return character followed by a
line feed character &lt;code&gt;&amp;lt;CR&amp;gt;&amp;lt;LF&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Independently of which type of interception technology is used, matching takes
place by observing the HTTP Host header field. There are some good technical
reasons to implement the matching in this way. Filtering gear does not need to
keep track of IP addresses, can operate in stealth mode as it does not need to
perform any name resolution and inspecting packets for this header is as
technically challenging as keeping track of the content of the full HTTP
sessions.&lt;/p&gt;

&lt;p&gt;This matching method is simple and even more effective with the current trend
of webservers or websites to force users to use the correct domain name when
requesting resources from the server.&lt;/p&gt;

&lt;h2 id=&#34;filtering:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;Filtering&lt;/h2&gt;

&lt;p&gt;Once the matching is positive, blocking can take place if desired. We have
identified three basic methods used to block a session. Reset, Proxying and
Active Redirection.&lt;/p&gt;

&lt;h3 id=&#34;reset:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;Reset&lt;/h3&gt;

&lt;p&gt;In the reset method, two RST packets will be send to both ends of the
communication. By injecting these two packets between the communicating
parties, both the Internet user/browser and the blacklisted webserver will be
instructed to terminate the connection. This blocking method is present in
Turkmenistan when we could effectively trigger RST traffic as a result of a
domain name present in the Host Header.&lt;/p&gt;

&lt;p&gt;To verify if the traffic between the browser and the blocked website was fully
blocked, we decided to ignore RST packets in both ends of the communication.
The result of the experiment is that it was possible to visit the blocked
website and the interception gear was not implementing a full blocking of all
traffic. Unfortunately ignoring all RST packets is not possible and makes this
method to bypass the blocking unpractical.&lt;/p&gt;

&lt;p&gt;There are some good technical reasons why filtering is implemented using RST
packets. The filtering gear does not need to keep track of each of the sessions
(stateless) and the blocking can take place without major changes in an
existing network infrastructure. The fact that reset blocking limits itself to
inject bogus traffic without modifying legitimate traffic facilitates its
implementation and scalability.&lt;/p&gt;

&lt;p&gt;An interesting collateral effect of RST blocking is passive redirection. Due to
backward compatibility with HTTP/1.0, when browsers receive a RST packet that
instruct them to close the connection, a new browser connection is initiated
against the same website but this time without the Host header. When the
browser receives the RST, it believes it is communicating to an old webserver
that does not support HTTP/1.1 and hence initiates a HTTP/1.0 session. This
session will not be &amp;ldquo;matched&amp;rdquo; by the interception gear and will not be blocked.
The website receiving the HTTP/1.0 connection will then send a redirection to
the default domain hosted at its IP address. For example, a HTTP/1.0 connection
to youtube.com will respond with a redirection to google.com. The user might
believe that the redirection is implemented by the filtering infrastructure
when in fact is a collateral results of the RST traffic.&lt;/p&gt;

&lt;h3 id=&#34;proxying:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;Proxying&lt;/h3&gt;

&lt;p&gt;The second mechanism to block the websites is by means of semi or fully
transparent proxies. In both cases the HTTP proxy is placed between the users
and the Internet. All outgoing web connections are intercepted by the proxy.
Depending on the technology used, the proxy can hide its presence to the
end-user (semi transparent), the webserver or both (fully transparent). The
most common transparent proxy implementation is the semi-transparent; this
implementation intercepts the HTTP requests from the users and places the
outbound connection on the users&amp;rsquo; behalf but does not hide the web proxy IP
address from the webserver i.e. the webserver can see that the connections do
not come from the user directly but from the IP address of the proxy.&lt;/p&gt;

&lt;p&gt;A fully transparent web proxy hides both from the user and the webserver that
the sessions are intercepted. The webserver cannot determine if the connection
comes directly from the end-user or the proxy itself. Semi-transparent proxies
are commonly used in combination with caching to speed up connections while
fully transparent proxies are typically implemented for surveillance.&lt;/p&gt;

&lt;p&gt;The basic matching mechanism in any case is performed looking into the Host
Header. Opposite to the RST blocking mechanism, the web proxy has full access
to the data stream and can perform most complex string matching, for example:
blocking certain articles or random pages based on keywords. The transparent
webproxy can perform more complex filtering but requires the processing of all
web requests in the infrastructure.&lt;/p&gt;

&lt;p&gt;This blocking method is present in Uzbekistan and Turkmenistan where we
could effectively identify proxy headers when requesting blocked websites.&lt;/p&gt;

&lt;h3 id=&#34;active-redirection:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;Active redirection&lt;/h3&gt;

&lt;p&gt;In  the same way that a RST packets can be injected in the datastream to
teardown a connection, we have seen another type of injected traffic towards
the client. In this scenario the interception gear sends a HTTP  302
redirection packet informing to the browser that the website has  been &amp;ldquo;Moved&amp;rdquo;
to another location.&lt;/p&gt;

&lt;p&gt;Instead of having a full web proxy implementation to perform the redirection,
we could determine that this type of redirection is performed without the need
of keep any session state. As in the case of the RST blocking, once the  Host
header is found a packet with a redirection to www.msn.com is sent to the
client.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;GET / HTTP/1.1
User-Agent: TLT/2.6.4 (linux-gnu)
Accept: */*
Host: www.uznews.net
Connection: Keep-Alive 

HTTP/1.1 302 Found
Location: http://www.msn.com/
Content-Type: text/html; charset=utf-8
Content-Length: 136
Connection: close

&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;Object moved&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt; &amp;lt;h2&amp;gt;Object moved to &amp;lt;a
href=&#39;http://www.msn.com/&#39;&amp;gt;here&amp;lt;/a&amp;gt;.&amp;lt;/h2&amp;gt; &amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This redirection method is highly scalable and users are aware that blocking
is talking place.&lt;/p&gt;

&lt;h2 id=&#34;how-we-manage-to-bypass-the-blocking:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;How we manage to bypass the blocking?&lt;/h2&gt;

&lt;p&gt;During our investigation we discovered that it is possible to bypass the
filtering by tampering the Host header so the matching stage is not
triggered.&lt;/p&gt;

&lt;p&gt;The basic idea is to use the &lt;code&gt;\t&lt;/code&gt; (TAB) and &lt;code&gt;\n&lt;/code&gt; (linefeed) characters in the
basic HTTP requests headers. We could test and verify that webservers
sanitize the requests headers and appending a tab character at the end of the
Host Header will not have an impact in the webserver side but will bypass the
detection-matching phase of the blocking gear.&lt;/p&gt;

&lt;p&gt;So instead of sending &lt;code&gt;Host: www.youtube.com\n&lt;/code&gt; our requests look like &lt;code&gt;Host:
www.youtube.com\t\n&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;We also discovered that the Active Redirection Method could be bypassed by
pre-pending a linefeed to the GET header. So instead of sending &lt;code&gt;GET /
HTTP/1.1&lt;/code&gt;, our requests look like &lt;code&gt;\nGET / HTTP/1.1&lt;/code&gt;.&lt;/p&gt;

&lt;h1 id=&#34;ooni-testing:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;OONI Testing&lt;/h1&gt;

&lt;p&gt;We ran from inside of TM and UZ a set of ooniprobe tests to collect some data
on how the filtering was happening and confirm our hypothesis of censorship
bypassing strategies.&lt;/p&gt;

&lt;p&gt;Inside of Uzbekistan we ran the following tests:&lt;/p&gt;

&lt;h3 id=&#34;http-header-field-manipulation:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;HTTP Header Field Manipulation&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://ooni.torproject.org/reports/0.1/TM/http_header_field_manipulation-2013-01-28T195727Z-AS20661.yamloo&#34;&gt;https://ooni.torproject.org/reports/0.1/TM/http_header_field_manipulation-2013-01-28T195727Z-AS20661.yamloo&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Through such test we were able to determine that no extra HTTP header were
being appended to our outgoing requests. As we can see the response body
contains the same headers that have been sent by the client.&lt;/p&gt;

&lt;h3 id=&#34;http-invalid-request-line-test:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;HTTP Invalid Request Line test&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://ooni.torproject.org/reports/0.1/TM/http_invalid_request_line-2013-01-30T214938Z-AS20661.yamloo&#34;&gt;https://ooni.torproject.org/reports/0.1/TM/http_invalid_request_line-2013-01-30T214938Z-AS20661.yamloo&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Through such test we were able to determine that the DPI device does not
misbehave when receiving an invalid request line. This leads us to believe that
the device in question is not a bluecoat device since such devices usually
crash on &amp;lsquo;test_random_invalid_version_number&amp;rsquo; and
&amp;lsquo;test_random_invalid_field_count&amp;rsquo; as is shown in the measurements done in
Myanmar (&lt;a href=&#34;https://ooni.torproject.org/reports/0.1/MM/http_invalid_request_line-2012-12-06T162217Z-AS18399.yamloo&#34;&gt;https://ooni.torproject.org/reports/0.1/MM/http_invalid_request_line-2012-12-06T162217Z-AS18399.yamloo&lt;/a&gt;).&lt;/p&gt;

&lt;h3 id=&#34;http-host-test:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;HTTP Host test&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://ooni.torproject.org/reports/0.1/TM/http_host-2013-01-30T224041Z-AS20661.yamloo&#34;&gt;https://ooni.torproject.org/reports/0.1/TM/http_host-2013-01-30T224041Z-AS20661.yamloo&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Through this test we were able to confirm that the above described filtering
bypassing strategies do indeed work as is shown by
&amp;lsquo;test_filtering_prepend_newline_to_method&amp;rsquo; and
&amp;lsquo;test_filtering_add_tab_to_host&amp;rsquo;. We were also able to determine that filtering
also occurs on subdomains of the target hostname as is shown by
&amp;lsquo;test_filtering_of_subdomain&amp;rsquo;.  Notes: The &amp;lsquo;response_never_received&amp;rsquo; error code
is due to a TCP RST.&lt;/p&gt;

&lt;p&gt;Inside of Turkmenistan we ran the same tests and obtained very similar results:&lt;/p&gt;

&lt;h3 id=&#34;http-header-field-manipulation-1:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;HTTP Header Field Manipulation&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://ooni.torproject.org/reports/0.1/UZ/http_header_field_manipulation-2013-01-29T222932Z-AS31203.yamloo&#34;&gt;https://ooni.torproject.org/reports/0.1/UZ/http_header_field_manipulation-2013-01-29T222932Z-AS31203.yamloo&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;http-invalid-request-line-test-1:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;HTTP Invalid Request Line test&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://ooni.torproject.org/reports/0.1/UZ/http_invalid_request_line-2013-02-02T183110Z-AS31203.yamloo&#34;&gt;https://ooni.torproject.org/reports/0.1/UZ/http_invalid_request_line-2013-02-02T183110Z-AS31203.yamloo&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;http-host-test-1:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;HTTP Host test&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://ooni.torproject.org/reports/0.1/UZ/http_host-2013-02-02T183406Z-AS31203.yamloo&#34;&gt;https://ooni.torproject.org/reports/0.1/UZ/http_host-2013-02-02T183406Z-AS31203.yamloo&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also here censorship of subdomains is occurring, though the filtering strategy
is to reply with a 302 redirect to &amp;lsquo;&lt;a href=&#34;http://www.msn.com&#39;&#34;&gt;http://www.msn.com&#39;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Such results are particularly interesting, because we are now able to test for
these bypassing strategies in the future. If it&amp;rsquo;s possible to circumvent
censorship by means of these two strategies we can infer that the DPI device we
are facing could be similar to these.  If we continue doing this we will be
developing a heuristic for categorizing DPI devices.&lt;/p&gt;

&lt;p&gt;Something similar was done in the case of Bluecoat in Burma, where we
discovered that by sending an invalid HTTP method in the Request Line would
cause a bluecoat device to output an error message. The same thing happens to
bluecoat, though with a different error message, when sending an invalid number
of parts in the HTTP request line.&lt;/p&gt;

&lt;h1 id=&#34;lessons-learned:a5b4590d88b489245f39120c3b9f8a5b&#34;&gt;Lessons learned&lt;/h1&gt;

&lt;p&gt;We learned that censorship software is not perfect and that sometimes it can be
trivially bypassed. The fact that it can be bypassed is not of interest to who
deploys such software, because they are mainly interested in affecting a large
portion of their userbase and even if a select few is able to access restricted
content it is generally not a problem.
This means that they accept the fact that there is an imbalance in knowledge
amongst their population and this strengthens social inequality.&lt;/p&gt;

&lt;p&gt;What is of interest to the OONI project is the fact that by detecting such
imperfections in filtering software we are able to classify the kind of product
being used. The next time we will see a device that can be bypassed by append
tab characters to the &lt;code&gt;Host&lt;/code&gt; header field we can infer that it may be the same
used in UZ and TZ.&lt;/p&gt;

&lt;p&gt;You can help us detect censorship by running ooni-probe. For more details see
the &lt;a href=&#34;https://github.com/thetorproject/ooni-probe#ooniprobe---open-observatory-of-network-interference&#34;&gt;install guide&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Hadara Palestine</title>
      <link>/post/hadara-palestine/</link>
      <pubDate>Mon, 23 Apr 2012 00:00:00 +0000</pubDate>
      
      <guid>/post/hadara-palestine/</guid>
      <description>

&lt;p&gt;&lt;strong&gt;ooni_test:&lt;/strong&gt; HTTP Host&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;country:&lt;/strong&gt; Palestine&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;provider:&lt;/strong&gt; Hadara, Paltel&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;product:&lt;/strong&gt; Squid&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;product_website:&lt;/strong&gt; &lt;a href=&#34;http://www.squid-cache.org/&#34;&gt;http://www.squid-cache.org/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;censorship method:&lt;/strong&gt; Transparent HTTP proxy&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;downloads:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;/post/hadara-palestine/hadara_palestine.yamlooni.tar.gz&#34;&gt;Full scan result&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/post/hadara-palestine/censored-sites.txt&#34;&gt;List of censored sites&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This is the technical report on the politically motivated censorship going on
in Bethlehem, West Bank.&lt;/p&gt;

&lt;p&gt;These are the networks in question:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;inetnum:         82.205.96.0 - 82.205.103.255
netname:         GZ-HOME-BR1
descr:           GAZA BSA HOME
country:         PS
admin-c:         WK4085-RIPE
tech-c:          HT1472-RIPE
status:          ASSIGNED PA
mnt-by:          Palnet-mnt
source:          RIPE # Filtered

inetnum:         212.106.88.0 - 212.106.95.255
netname:         RA-HM-ASR-02
descr:           Hadara Ramallah BSA
country:         PS
admin-c:         WK4085-RIPE
tech-c:          HT1472-RIPE
status:          Assigned PA
mnt-by:          Palnet-MNT
source:          RIPE # Filtered
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The technique being used to restrict access to content is a transparent HTTP
proxy. What this does is intercept every HTTP request being made and process it
internally. If the content is cached it will serve the cached version of the
content. If the content is to be blocked it will serve a blocked page.&lt;/p&gt;

&lt;p&gt;We developed a test that opens a connection on port 80 towards a known
unrestricted host. Keep in mind that it&amp;rsquo;s irrelevant to what destination the
connection is opened because the transparent HTTP proxy will intercept all HTTP
requests, meaning that all clients are in reality always only speaking to the proxy.
Once we have a connection open we do HTTP GET requests with a changed Host header field.
If the result is the block page then the content is restricted.&lt;/p&gt;

&lt;p&gt;We have identified two different block pages that were interchanged at a
certain point during our tests:&lt;/p&gt;

&lt;h3 id=&#34;first-block-page:b0dbb69a6dab18418418d2a3a0b9d948&#34;&gt;First block page&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;HTTP/1.0 403 Forbidden
Server: squid
Date: Wed, 11 Apr 2012 05:47:10 GMT
Content-Type: text/html
Content-Length: 21
Connection: close

Sorry, Access Denied
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;second-block-page:b0dbb69a6dab18418418d2a3a0b9d948&#34;&gt;Second block page&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;HTTP/1.0 403 Forbidden
Server: squid
Date: Sun, 22 Apr 2012 20:55:34 GMT
Content-Type: text/html
Content-Length: 2205
Connection: close

&amp;lt;!DOCTYPE HTML PUBLIC &amp;quot;-//W3C//DTD HTML 4.01 Transitional//EN&amp;quot; &amp;quot;http://www.w3.org/TR/html4/loose.dtd&amp;quot;&amp;gt;
&amp;lt;html&amp;gt;
    &amp;lt;head&amp;gt;
        &amp;lt;meta http-equiv=&amp;quot;Content-type&amp;quot; content=&amp;quot;text/html; charset=iso-8859-1&amp;quot;&amp;gt;
        &amp;lt;title&amp;gt;ERROR: The requested URL could not be retrieved&amp;lt;/title&amp;gt;
        &amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;
            #logo {
                margin: 0 auto;
                display: block;
            }
            hr {
                height: 1px;
                border: none;
                background: gray;
                margin: 1em 0;
            }
            h1 {
                padding: 0;
                font-size: 1.5em;
                margin: 0;
            }
            h2 {
                padding: 0;
                font-size: 1.2em;
                margin: 0 0 1em 0;
            }
            body {
                font-family: sans-serif;
                padding: 1em 0;
            }
            #content {
                margin: 0 auto;
                max-width: 800px;
                border: 1px solid gray;
                background: #eee;
                padding: 1em 2em;
                -moz-border-radius: 16px;
            }
        &amp;lt;/style&amp;gt;
    &amp;lt;/head&amp;gt;
    &amp;lt;body&amp;gt;
        &amp;lt;div id=&amp;quot;content&amp;quot;&amp;gt;

        &amp;lt;h1&amp;gt;ERROR&amp;lt;/h1&amp;gt;
        &amp;lt;h2&amp;gt;The requested URL could not be retrieved&amp;lt;/h2&amp;gt;
        &amp;lt;hr/&amp;gt;

&amp;lt;P&amp;gt;
While trying to retrieve the URL:
&amp;lt;A HREF=&amp;quot;http://fateh-voice.ps/&amp;quot;&amp;gt;http://fateh-voice.ps/&amp;lt;/A&amp;gt;
&amp;lt;P&amp;gt;
The following error was encountered:
&amp;lt;UL&amp;gt;
&amp;lt;LI&amp;gt;
&amp;lt;STRONG&amp;gt;
Access Denied.
&amp;lt;/STRONG&amp;gt;
&amp;lt;P&amp;gt;
Access control configuration prevents your request from
being allowed at this time.  Please contact your service provider if
you feel this is incorrect.
&amp;lt;/UL&amp;gt;
&amp;lt;P&amp;gt;Your cache administrator is &amp;lt;A HREF=&amp;quot;mailto:webmaster&amp;quot;&amp;gt;webmaster&amp;lt;/A&amp;gt;.
        &amp;lt;/div&amp;gt;
    &amp;lt;!--
  -- Unfortunately, Microsoft has added a clever new
  -- feature to Internet Explorer.  If the text in
  -- an errors message is too small, specifically
  -- less than 512 bytes, Internet Explorer returns
  -- its own error message.  Yes, you can turn that
  -- off, but *surprise* its pretty tricky to find
  -- buried as a switch called smart error
  -- messages  That means, of course, that many of
  -- Resins error messages are censored by default.
  -- And, of course, youll be shocked to learn that
  -- IIS always returns error messages that are long
  -- enough to make Internet Explorer happy.  The
  -- workaround is pretty simple: pad the error
  -- message with a big comment to push it over the
  -- five hundred and twelve byte minimum.  Of course,
  -- thats exactly what youre reading right now.
//--&amp;gt;
&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;From the response headers of a blocked page we are able to learn that the
software being used is Squid.&lt;/p&gt;

&lt;p&gt;We scanned more than 1 million hostnames and only detected censorship on 8 of
these.
The full scan results are available in an unredacted from &lt;a href=&#34;/post/hadara-palestine/hadara_palestine.yamlooni.tar.gz&#34;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;At a certain point we decided to go for a high level of parallelism and not
care about timeout errors. This is because the transparent HTTP proxy is
intercepting our request and making them for us. This means that if a
certain hostname is to be blocked it will reply with the block page
instantenously without processing it. If the site is in the blocklist a
connection attempt to it will never timeout.&lt;/p&gt;

&lt;p&gt;What this means, though, is that sites blocked with some more sophisticated
techniques would not have been detected. Though by seeing the kind of setup
that was deployed in this case we find it unlikely that access to content
would be restricted with some more advanced setup and that they would be
using a mix between squid transparent HTTP proxy censorship and other.&lt;/p&gt;

&lt;p&gt;The sites whose access is being restricted access to are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;pal-home.net&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;kofiapress.com&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;amad.ps&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;inlightpress.com&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;fpnp.net&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;fateh-voice.ps&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;karamapress.com&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;milad.ps&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&#34;/post/hadara-palestine/screenshot/palhome.png&#34; alt=&#34;http://pal-home.net&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://pal-home.net&#34;&gt;http://pal-home.net&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/hadara-palestine/screenshot/milad.png&#34; alt=&#34;http://milad.ps&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://milad.ps&#34;&gt;http://milad.ps&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/hadara-palestine/screenshot/karamapress.png&#34; alt=&#34;http://karamapress.com&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://karamapress.com&#34;&gt;http://karamapress.com&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/hadara-palestine/screenshot/inlightpress.png&#34; alt=&#34;http://inlightpress.com&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://inlightpress.com&#34;&gt;http://inlightpress.com&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/hadara-palestine/screenshot/fpnp.png&#34; alt=&#34;http://fpnp.net&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://fpnp.net&#34;&gt;http://fpnp.net&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/hadara-palestine/screenshot/fateh-voice.png&#34; alt=&#34;http://fateh-voice.ps&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://fateh-voice.ps&#34;&gt;http://fateh-voice.ps&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/hadara-palestine/screenshot/amad.png&#34; alt=&#34;http://amad.ps&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://amad.ps&#34;&gt;http://amad.ps&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For more details on the political implications check see the &lt;a href=&#34;http://www.maannews.net/eng/ViewDetails.aspx?ID=478726&#34;&gt;article by George
Hale on Ma&amp;rsquo;An News&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>T-Mobile USA Web Guard</title>
      <link>/post/t-mobile-usa-web-guard/</link>
      <pubDate>Wed, 21 Mar 2012 00:00:00 +0000</pubDate>
      
      <guid>/post/t-mobile-usa-web-guard/</guid>
      <description>

&lt;p&gt;&lt;strong&gt;ooni_test:&lt;/strong&gt; HTTP Host&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;country:&lt;/strong&gt; United States&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;provider:&lt;/strong&gt; T-Mobile USA&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;product:&lt;/strong&gt; Web Guard&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;product_website:&lt;/strong&gt; &lt;a href=&#34;http://support.t-mobile.com/docs/DOC-2144&#34;&gt;http://support.t-mobile.com/docs/DOC-2144&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;censorship_method:&lt;/strong&gt; Transparent HTTP proxy&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;downloads:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;/post/t-mobile-usa-web-guard/t-mobile-scan.yamlooni.tar.gz&#34;&gt;Full scan result&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/post/t-mobile-usa-web-guard/t-mobile-scan-blockedsites.txt&#34;&gt;List of censored sites&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/post/t-mobile-usa-web-guard/t-mobile-scan-blockedsites-categorized.txt&#34;&gt;Categories of censored sites&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;T-Mobile USA offers a &amp;ldquo;feature&amp;rdquo; to restrict access to certain
kinds of content. This is called Web Guard. Supposedly Web Guard
is supposed to inhibit access to content that falls under the
following categories: Alcohol, Mature Content, Violence,
Drugs, Pornography,  Weapons, Gambling, Suicide, Guns, Hate,
Tobacco, Ammunition.&lt;/p&gt;

&lt;p&gt;By developing an OONI-probe test we were able to extract part of
the list of censored content and discovered that sites that do
not fall under these categories were also censored.
This feature is enabled by default on all prepaid accounts and
although it can be disabled by customers who wish to do so
(if over 18 years of age), it is not clearly stated in the
error page how to do so. This means that T-Mobile USA customers may
be drawn into the Filternet without knowing how to get out.&lt;/p&gt;

&lt;h3 id=&#34;how-is-the-censorship-performed:5e16e4edcdf1b5c1f1e992db091a3309&#34;&gt;How is the censorship performed?&lt;/h3&gt;

&lt;p&gt;The technique being used by T-Mobile USA to restrict access to certain content
involves deploying a transprent HTTP proxy. This proxy intercepts every HTTP
packet going through the network and checks it&amp;rsquo;s Host header field to see if
it on the censored list. If the site is to be blocked it injects a fake response
warning the user of the block. What this means is that the block is only effective
against unencrypted HTTP traffic, but does not work for encrypted HTTPs traffic.&lt;/p&gt;

&lt;h3 id=&#34;some-sites-should-not-be-censored:5e16e4edcdf1b5c1f1e992db091a3309&#34;&gt;Some sites should not be censored&lt;/h3&gt;

&lt;p&gt;While most of the censored sites are legitimately categorized, there are certain
ones that do not fall under the categories of the block.
Here is a list of sites that we found to be censored, but that we don&amp;rsquo;t believe
belong to any of the following categories Alcohol, Mature Content, Violence,
Drugs, Pornography, Weapons, Gambling, Suicide, Guns, Hate, Tobacco, Ammunition.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/torproject.org.png&#34; alt=&#34;The Tor Project is dedicated to proving anonymous secure communication&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://torproject.org&#34;&gt;The Tor Project is dedicated to proving anonymous secure communication&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/italian-censorship.png&#34; alt=&#34;This is one of the most interestingly blocked website. Italy practices DNS based censorship for website that are related to
  online gambling. This is the block page is displayed when the IP address in the DNS response is spoofed. This is meta censorship! &#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://217.175.53.72/&#34;&gt;This is one of the most interestingly blocked website. Italy practices DNS based censorship for website that are related to
  online gambling. This is the block page is displayed when the IP address in the DNS response is spoofed. This is meta censorship! &lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/web.archive.org.png&#34; alt=&#34;The internet archive Way Back Machine. The Library of the Internet.&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://web.archive.org/&#34;&gt;The internet archive Way Back Machine. The Library of the Internet.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/newgrounds.com.png&#34; alt=&#34;Newgrounds is an American entertainment and social media website. &#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://newgrounds.com&#34;&gt;Newgrounds is an American entertainment and social media website. &lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/wjunction.com.png&#34; alt=&#34;Webmaster Hangout&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://wjunction.com/&#34;&gt;Webmaster Hangout&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/logicalmedia.com.png&#34; alt=&#34;Logical Media is an Affiliate Network.&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://logicalmedia.com/&#34;&gt;Logical Media is an Affiliate Network.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/cosmopolitan.com.png&#34; alt=&#34;Cosmopolitan is an international magazine for women. &#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://cosmopolitan.com/&#34;&gt;Cosmopolitan is an international magazine for women. &lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/nullrefer.com.png&#34; alt=&#34;Hide Refer hides the visitors HTTP refer from being seen by other websites&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://nullrefer.com/&#34;&gt;Hide Refer hides the visitors HTTP refer from being seen by other websites&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/sportscn.com.png&#34; alt=&#34;Chinese sports news website&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://sportscn.com/&#34;&gt;Chinese sports news website&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/programme.tv.png&#34; alt=&#34;French TV guide website.&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://programme.tv/&#34;&gt;French TV guide website.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/nulled.cc.png&#34; alt=&#34;Russian programming forum&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://nulled.cc/&#34;&gt;Russian programming forum&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/ir-tci.org.png&#34; alt=&#34;Iranian Forum&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://ir-tci.org/&#34;&gt;Iranian Forum&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/zonebourse.com.png&#34; alt=&#34;French economics and financial news site&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://zonebourse.com/&#34;&gt;French economics and financial news site&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/hackbase.com.png&#34; alt=&#34;Chinese computer security website&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://hackbase.com/&#34;&gt;Chinese computer security website&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/whatreallyhappened.com.png&#34; alt=&#34;9/11 conspiracy theory news site&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://whatreallyhappened.com/&#34;&gt;&lt;sup&gt;9&lt;/sup&gt;&amp;frasl;&lt;sub&gt;11&lt;/sub&gt; conspiracy theory news site&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/p.tl.png&#34; alt=&#34;Japanese URL shortening service&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://p.tl/&#34;&gt;Japanese URL shortening service&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/10minutesaperdre.fr.png&#34; alt=&#34;French funny news website&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://10minutesaperdre.fr/&#34;&gt;French funny news website&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/statsie.com.png&#34; alt=&#34;Website statistics collection site&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://statsie.com/&#34;&gt;Website statistics collection site&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/bbcprofit.com.png&#34; alt=&#34;Financial advice website&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://bbcprofit.com/&#34;&gt;Financial advice website&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/el-annuaire.com.png&#34; alt=&#34;French website index&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://el-annuaire.com/&#34;&gt;French website index&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/livesports.pl.png&#34; alt=&#34;Polish sports news website&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://livesports.pl/&#34;&gt;Polish sports news website&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/titan007.com.png&#34; alt=&#34;Chinese sports news website&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://titan007.com/&#34;&gt;Chinese sports news website&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/girlpower.it.png&#34; alt=&#34;Italian women advice website&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://girlpower.it/&#34;&gt;Italian women advice website&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/yusukebe.com.png&#34; alt=&#34;Japanese blog&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://yusukebe.com/&#34;&gt;Japanese blog&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/sougouwiki.com.png&#34; alt=&#34;Japanese wiki&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://sougouwiki.com/&#34;&gt;Japanese wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/wiki-live.com.png&#34; alt=&#34;Online Article directory&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://wiki-live.com/&#34;&gt;Online Article directory&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/hltv.org.png&#34; alt=&#34;Sports news website&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://hltv.org/&#34;&gt;Sports news website&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/elu24.ee.png&#34; alt=&#34;Estonian news portal&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://elu24.ee/&#34;&gt;Estonian news portal&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/pitsirikos.net.png&#34; alt=&#34;Greek political blog&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://pitsirikos.net/&#34;&gt;Greek political blog&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/kath.net.png&#34; alt=&#34;Religious news site&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://kath.net/&#34;&gt;Religious news site&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/hackforums.net.png&#34; alt=&#34;Computer security Forum&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://hackforums.net/&#34;&gt;Computer security Forum&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/post/t-mobile-usa-web-guard/screenshot/echartsinfrance.net.png&#34; alt=&#34;French pop music hit list&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.chartsinfrance.net/&#34;&gt;French pop music hit list&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;what-can-we-learn-from-this:5e16e4edcdf1b5c1f1e992db091a3309&#34;&gt;What can we learn from this?&lt;/h3&gt;

&lt;p&gt;That if you are a Chinese sports fan or a French interested in economics under
18 you will have a hard time going with T-Mobile in the US. There appears to be
overall a tendency to blocking foreign sports news websites.&lt;/p&gt;

&lt;p&gt;When I asked T-Mobile US about the matter this is what came out with the
following:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; Arturo Filastò @hellais
@TMobileHelp Under what category does http://torproject.org fall under? I don&#39;t see any reason for it being blocked. @mikavienna @ioerror

 T-Mobile USA @TMobileHelp
Hi there. Here&#39;s more info about webguard. http://ow.ly/9JbxO Please let us know if we can help. ^CG

 Arturo Filastò @hellais
@TMobileHelp Why is web guard blocking http://torproject.org? It does not appear to belong to the filtered categories.

 T-Mobile USA @TMobileHelp
@hellais @MiKaVienna @ioerror http://torproject.org is not blocked. There must be a webguard on your line. Please contact us to resolve. ^CG

 Arturo Filastò  @hellais
Wonder what keywords it picket up in @torproject that fit in these categories: http://support.t-mobile.com/docs/DOC-2144#What_categories_will_be_completely_restricted_with_the_Web_Guard_feature

 T-Mobile USA  @TMobileHelp
My guess would be system picked up keywords there. Let us know if we can assist in turning webguard off. ^CG

 Arturo Filastò  @hellais
Also, doesn&#39;t t-mobile buy the list of censored sites from a third party? Or does it compile it itself?

 T-Mobile USA @TMobileHelp
My guess would be system picked up keywords there. Let us know if we can assist in turning webguard off. ^CG

 Arturo Filastò @hellais
My questions are: why is Web Guard enabled on my account and why sites such as http://torproject.org are filtered.

 T-Mobile USA @TMobileHelp
I don&#39;t have enough information to speculate further about the details. I CAN help you turn off webguard? ^CG

 Arturo Filastò @hellais
@TMobileHelp what leads TMobile to believe that a customer is interested in censorship? Is Web Guard activated on all prepaid accounts?

 T-Mobile USA @TMobileHelp
Must be because when your account was set up, we thought you wanted it. If you don&#39;t, please contact us: http://ow.ly/9JllQ ^CG
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So T-Mobile is basically interfering into what should be taught by
parents to their children. Since most of prepaid customers are
under 18 they reserve the right to decide what is right and wrong
for them, even bypassing their parents.&lt;/p&gt;

&lt;p&gt;If I were a parent I would be mad that T-Mobile US chooses for my
what my child should watch and should not.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>